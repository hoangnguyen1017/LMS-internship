<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Trang chá»§{% endblock %}</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    {% block extra_css %}{% endblock %}
</head>
<style>
    html {
    font-size: 85%; 
  }
</style>

<body>
    <div class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container-fluid">
            {% if user.is_authenticated %}
                {% if request.user.is_superuser and request.session.temporary_role == 'Student' %}
                    {% include "student_navbar.html" %}
                {% elif request.user.profile.role.role_name == 'Student' %}
                    {% include "student_navbar.html" %}
                {% else %}
                    {% include "admin_navbar.html" %}
                {% endif %}
            {% else %}
                {% include "admin_navbar.html" %}
            {% endif %}
        </div>
    </div>

    <div class="container-fluid" style="display: flex; flex-direction: column;">
        <button id="sidebarToggle" class="btn btn-outline-primary position-fixed" 
                style="top: 10px; left: 10px; z-index: 1000;">
            <i class="fas fa-arrow-alt-circle-right mt-1" style="font-size: 22px;"></i>
        </button>
    
        <div class="row mt-5" style="flex-grow: 1;">
            {% if user.is_authenticated %}
                {% if request.user.profile.role.role_name != 'Student' and request.session.temporary_role != 'Student' %}
                <div class="col-md-2 col-sm-12 bg-dark mt-2" id="sidebar" 
                     style="overflow-y: auto; height: 95%; position: fixed; z-index:10; 
                     {% if request.resolver_match.app_name == 'student_portal' %}
                         transform: translateX(-100%);
                     {% else %}
                         transform: translateX(0);
                     {% endif %}
                     transition: transform 0.3s ease;">
                        {% include "admin_sidebar.html" %}
                </div>
                {% endif %}
            {% endif %}
        
            <div class="mt-3
                {% if user.is_authenticated %}
                    {% if request.resolver_match.app_name == "student_portal" or request.user.profile.role.role_name == 'Student' or request.session.temporary_role == 'Student' %}
                        col-sm-12
                    {% else %}
                        col-md-10 col-sm-12 offset-md-2
                    {% endif %}
                {% else %}
                    col-sm-12
                {% endif %}
            " id="mainContentArea" style="transition: margin-left 0.3s ease;">
                {% block content %}{% endblock %}
            </div>
        </div>
        
    </div>
    
    <button onclick="scrollToTop()" id="scrollToTopButton" title="Top page"
            class="btn position-fixed d-none rounded-circle p-2 shadow-lg"
            style="font-size: 20px; bottom: 3vh; right: 20px; transition: opacity 0.3s; background-color: black; color: white;">
        <i class="fas fa-arrow-up"></i>
    </button>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/js-yaml/4.1.0/js-yaml.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.min.js"></script>

    <script>
        window.onscroll = function() {
            var scrollToTopButton = document.getElementById("scrollToTopButton");
    
            if (document.body.scrollTop > 100 || document.documentElement.scrollTop > 100) {
                scrollToTopButton.classList.remove("d-none");
            } else {
                scrollToTopButton.classList.add("d-none");
            }
        };
    
        function scrollToTop() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
    </script>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const dropdownLinks = document.querySelectorAll('[data-bs-toggle="dropdown"], [data-bs-toggle="collapse"]');
            dropdownLinks.forEach(link => {
                link.addEventListener('click', function (e) {
                    e.preventDefault();
                });
            });
        });
    </script>
    {% block extra_js %}{% endblock %}
</body>
</html>